<div class="container mt-4">
  <h1 class="mb-4">Shopping Cart</h1>
  {{#if totalQty}}
    <div class="row">
      <div class="col-md-8">
        <div class="card mb-4">
          <div class="card-body">
            <table class="table">
              <thead>
                <tr>
                  <th>Product</th>
                  <th>Quantity</th>
                  <th>Price</th>
                  <th>Total</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
              {{#each products}}
                <tr>
                  <td>
                    <div class="d-flex align-items-center">
                      <img src="{{this.item.imagepath}}" alt="" style="width:80px;height:80px;object-fit:cover;margin-right:15px;" class="img-thumbnail">
                      <div>
                        <h6 class="mb-0">{{this.item.title}}</h6>
                        <small class="text-muted">{{this.item.description}}</small>
                      </div>
                    </div>
                  </td>
                  <td class="align-middle">
                    <div class="input-group" style="width: 120px;">
                      <button class="btn btn-sm btn-outline-secondary qty-decrease" data-id="{{this.item._id}}" type="button">-</button>
                      <input type="text" class="form-control form-control-sm text-center qty-input" value="{{this.qty}}" readonly>
                      <button class="btn btn-sm btn-outline-secondary qty-increase" data-id="{{this.item._id}}" type="button">+</button>
                    </div>
                  </td>
                  <td class="align-middle">${{this.item.Price}}</td>
                  <td class="align-middle"><strong>${{this.price}}</strong></td>
                  <td class="align-middle">
                    <button class="btn btn-sm btn-danger remove-item" data-id="{{this.item._id}}">
                      <i class="fas fa-trash"></i> Remove
                    </button>
                  </td>
                </tr>
              {{/each}}
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="card">
          <div class="card-header bg-primary text-white">
            <h5 class="mb-0">Order Summary</h5>
          </div>
          <div class="card-body">
            <div class="d-flex justify-content-between mb-2">
              <span>Subtotal ({{totalQty}} items):</span>
              <strong>${{totalPrice}}</strong>
            </div>
            <div class="d-flex justify-content-between mb-2">
              <span>Shipping:</span>
              <strong>$5.00</strong>
            </div>
            <div class="d-flex justify-content-between mb-2">
              <span>Tax (8%):</span>
              <strong>${{taxAmount}}</strong>
            </div>
            <hr>
            <div class="d-flex justify-content-between mb-3">
              <h5>Total:</h5>
              <h5 class="text-success">${{grandTotal}}</h5>
            </div>
            <a href="/checkout" class="btn btn-success btn-lg btn-block">
              <i class="fas fa-lock"></i> Proceed to Checkout
            </a>
            <a href="/home" class="btn btn-outline-secondary btn-block mt-2">
              <i class="fas fa-arrow-left"></i> Continue Shopping
            </a>
          </div>
        </div>
      </div>
    </div>
  {{else}}
    <div class="text-center py-5">
      <i class="fas fa-shopping-cart fa-5x text-muted mb-3"></i>
      <h3>Your cart is empty</h3>
      <p class="text-muted">Add some items to your cart to continue shopping</p>
      <a href="/home" class="btn btn-primary">
        <i class="fas fa-shopping-bag"></i> Start Shopping
      </a>
    </div>
  {{/if}}
</div>

<script>
  // Cart quantity update functionality will be added here
  document.querySelectorAll('.qty-increase, .qty-decrease, .remove-item').forEach(btn => {
    btn.addEventListener('click', function() {
      const action = this.classList.contains('qty-increase') ? 'increase' : 
                     this.classList.contains('qty-decrease') ? 'decrease' : 'remove';
      const productId = this.getAttribute('data-id');
      window.location.href = `/cart/${action}/${productId}`;
    });
  });
</script>
